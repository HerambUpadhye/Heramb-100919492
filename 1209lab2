# (Replace 'node:20-slim' with your actual base image, e.g., python:3.10-slim)
FROM node:20-slim

# 1. Set the working directory
WORKDIR /usr/src/app

# 2. Copy dependency files (for Node.js, this is package.json)
COPY package*.json ./

# 3. Install dependencies
# Using --production flag often saves space, but for a simple lab environment, this is fine
RUN npm install

# 4. Copy the rest of the application files, including your server startup file
COPY . .

# 5. Optional but good practice: tell the image which port to expect
# EXPOSE helps humans and local tools, but Cloud Run uses the runtime PORT env var.
EXPOSE 8080

# 6. Define the command to run your application.
# **CRITICAL CHANGE:** Execute 'node index.js' directly instead of using 'npm start'.
# This avoids the 'npm' wrapper script, making the process cleaner and more responsive.
CMD [ "node", "index.js" ]